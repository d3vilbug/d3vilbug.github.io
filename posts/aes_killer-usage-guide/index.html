<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="Abdul Wahab ">
<meta name="description" content="Demo App  For this usage guide, weI&amp;rsquo;ll be using the AES Killer - Demo App where I have simulated all possible scenarios with different variation in request and response to cover maximum possible combination which could occur. I have simulated the following test cases.
 Complete Request &amp;amp; Response Specific Request Parameters and complete response Specific JSON Request parameters &amp;amp; complete response Specific Request and Response Parameters Override Request &amp;amp; Response  The application is sending back post data in response" />
<meta name="keywords" content=", burp, aes-killer, burp-plugin, java, burpsuite, burpsuite-tools, burpsuite-plugin, burp-extension, decryptor, aes-encryption" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="" />
<link rel="canonical" href="https://n00b.sh/posts/aes_killer-usage-guide/" />


    <title>
        
            AES Killer - Usage Guide :: Abdul Wahab 
        
    </title>



<link href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/css/flag-icon.min.css" rel="stylesheet"
    type="text/css">



<link rel="stylesheet" href="https://n00b.sh/main.fed83d9bf8974397cb5a41241afee54198da6f49e81a94dd993d302f0fd2095a.css">




    <link rel="apple-touch-icon" sizes="180x180" href="https://n00b.sh/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="https://n00b.sh/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="https://n00b.sh/favicon-16x16.png">
    <link rel="manifest" href="https://n00b.sh/site.webmanifest">
    <link rel="mask-icon" href="https://n00b.sh/safari-pinned-tab.svg" color="#1b1c1d">
    <link rel="shortcut icon" href="https://n00b.sh/favicon.ico">
    <meta name="msapplication-TileColor" content="#1b1c1d">
    <meta name="theme-color" content="#1b1c1d">



<meta itemprop="name" content="AES Killer - Usage Guide">
<meta itemprop="description" content="Demo App  For this usage guide, weI&rsquo;ll be using the AES Killer - Demo App where I have simulated all possible scenarios with different variation in request and response to cover maximum possible combination which could occur. I have simulated the following test cases.
 Complete Request &amp; Response Specific Request Parameters and complete response Specific JSON Request parameters &amp; complete response Specific Request and Response Parameters Override Request &amp; Response  The application is sending back post data in response"><meta itemprop="datePublished" content="2021-04-18T00:00:00&#43;00:00" />
<meta itemprop="dateModified" content="2021-04-18T00:00:00&#43;00:00" />
<meta itemprop="wordCount" content="1075">
<meta itemprop="keywords" content="burp,aes-killer,burp-plugin,java,burpsuite,burpsuite-tools,burpsuite-plugin,burp-extension,decryptor,aes-encryption," />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="AES Killer - Usage Guide"/>
<meta name="twitter:description" content="Demo App  For this usage guide, weI&rsquo;ll be using the AES Killer - Demo App where I have simulated all possible scenarios with different variation in request and response to cover maximum possible combination which could occur. I have simulated the following test cases.
 Complete Request &amp; Response Specific Request Parameters and complete response Specific JSON Request parameters &amp; complete response Specific Request and Response Parameters Override Request &amp; Response  The application is sending back post data in response"/>






    <meta property="article:section" content="guide" />

    <meta property="article:section" content="pentest" />



    <meta property="article:published_time" content="2021-04-18 00:00:00 &#43;0000 UTC" />








    </head>

    
        <body>
    
    
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="https://n00b.sh/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">&gt;</span>
            <span class="logo__text">$ cd /home/n00b</span>
            <span class="logo__cursor" style=
                  "
                   
                   ">
            </span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="https://n00b.sh/posts">Posts</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            
            <span class="header__myCustom"> | </span>
                <span class="theme-toggle not-selectable"><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
   <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
   3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
   13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
 </svg></span>
        </span>
    </span>
</header>


            <div class="content">
                
    <main class="post">

        <div class="post-info">
            
            </p>
        </div>

        <article>
            <h2 class="post-title"><a href="https://n00b.sh/posts/aes_killer-usage-guide/">AES Killer - Usage Guide</a></h2>

            
            
            

            <div class="post-content">
                <h2 id="demo-app">Demo App</h2>
<hr>
<p>For this usage guide, weI&rsquo;ll be using the <a href="https://github.com/d3vilbug/demo-example-code-snippets/tree/master/AES_Killer-NodeJS-DemoApp" target=_blank>AES Killer - Demo App</a> where I have simulated all possible scenarios with different variation in request and response to cover maximum possible combination which could occur. I have simulated the following test cases.</p>
<ul>
<li>Complete Request &amp; Response</li>
<li>Specific Request Parameters and complete response</li>
<li>Specific JSON Request parameters &amp; complete response</li>
<li>Specific Request and Response Parameters</li>
<li>Override Request &amp; Response</li>
</ul>
<p>The application is sending back post data in response</p>
<h3 id="demo-app-setup">Demo App Setup</h3>
<p>Download the <a href="https://github.com/d3vilbug/demo-example-code-snippets/tree/master/AES_Killer-NodeJS-DemoApp" target=_blank>AES Killer - Demo App</a> and do the following</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ cd AES_Killer-NodeJS-DemoApp

// Install packages
$ npm install express
$ npm install body-parser
$ npm install crypto-js
$ npm install cors


// Start the server
$ node server.js
Express server started on port <span style="color:#ae81ff">3000</span> ...... 
</code></pre></div><p>The running app will look like this</p>
<img src="https://i.imgur.com/uFzlumM.png">
<p>I&rsquo;ll be using the following code snippet for the encryption and decryption in this demo where</p>
<ul>
<li>Secret key is <code>aaaaaaaaaaaaaaaa</code> and its base64 is <code>YWFhYWFhYWFhYWFhYWFhYQ==</code></li>
<li>IV Parameter is <code>bbbbbbbbbbbbbbbb</code> and its base64 is <code>YmJiYmJiYmJiYmJiYmJiYg==</code></li>
<li>As my Express server is running on localhost port 3000 so my host will be http://127.0.0.1:3000/</li>
</ul>
<img src="https://i.imgur.com/7gvIxLK.png">
<h2 id="aes-killer-setup">AES Killer Setup</h2>
<hr>
<p>Download the latest jar file from <a href="https://github.com/Ebryx/AES-Killer/releases" target=_blank>GitHub Release</a> and add it to Burp Extender.</p>
<img src="https://i.imgur.com/LKYQMoj.png">
<p>Now let&rsquo;s move towards the demo.</p>
<br>
<h2 id="example-01---complete-request-and-response-body">Example 01 - Complete Request and Response Body</h2>
<hr>
<p>If we issue a request upon pressing a Login button, we can observe that the application is sending complete requests and response body encrypted.</p>
<img src="https://i.imgur.com/dhv5qMM.png">
<p>The configuration of AES Killer for this example is quite simple, all we need to do is following</p>
<ul>
<li>Input <code>Secret Key</code>, <code>IV Parameter</code> and <code>Host URL</code></li>
<li>Select <code>Complete Request Body</code> from Request Options</li>
<li>Select <code>Complete Response Body</code> from Response Options</li>
<li>Press <strong><code>Start AES Killer</code></strong> button as shown below and you will get a prompt with <code>AES Killer started !!!</code></li>
</ul>
<img src="https://i.imgur.com/Cuxnhgb.png">
<p>Now again send the request from our demo web app and go back to burp proxy where you can see the decrypted request under Edited request and decrypted response under Original response options. Upon fetching the request on proxy</p>
<ul>
<li>IProxyListener.processProxyMessage will decrypt the request&rsquo;s body and update the request with a decrypted body</li>
<li>Before sending a request to the server, IHttpListener.processHttpMessage will encrypt the whole request&rsquo;s body and send the updated encrypted request to the server</li>
<li>On getting encrypted response IHttpListener.processHttpMessage will decrypt the response&rsquo;s body</li>
<li>IProxyListener.processProxyMessage will encrypt the decrypted request&rsquo;s body and update the request</li>
</ul>
<p>So by using the above flow, we can see and tamper <strong>clear text request</strong> in <strong>Burp Proxy, Repeater, Scanner, Intruder</strong> while the AES Killer will handle the encryption on the backend before sending it to Server and Application (Web / Mobile).</p>
<img src="https://i.imgur.com/yalMcsE.png">
<p>We can send this decrypted request to Repeater for further testing</p>
<img src="https://i.imgur.com/hPB0AG9.png">
<p>Now we can also do brute forcing using intruder</p>
<img src="https://i.imgur.com/EsIznh6.png">
<br>
<img src="https://i.imgur.com/ldIq7EK.png">
<br>
<img src="https://i.imgur.com/fDL9ez0.png">
<br>
<h2 id="example-02---specific-request-parameters-and-complete-response">Example 02 - Specific Request Parameters and Complete Response</h2>
<hr>
<p>In this example, the application is sending encrypted request parameters to the server and getting an encrypted response</p>
<img src="https://i.imgur.com/VLV2Lfi.png"> 
<p>To get plain text traffic in such cases, please use the following configuration for AES Killer</p>
<ul>
<li>Input <code>Secret Key</code>, <code>IV Parameters</code> and <code>Host URL</code></li>
<li>Select <code>Complete Response Body</code> from <code>Response Options</code></li>
<li>Select <code>Specific Request Parameters</code> from <code>Request Options</code> and provide <strong>parameter names</strong> separated with space</li>
<li>Press <code>Start AES Killer</code></li>
</ul>
<img src="https://i.imgur.com/c8pQEMg.png">
<p>Now trying sending Login request again and you&rsquo;ll see the decrypted request and response in burp</p>
<img src="https://i.imgur.com/yOR9y18.png">
<p>We can use this decrypted request in Repeater, Scanner and Intruder, same as the previous case.</p>
<br>
<h2 id="example-03---specific-json-request-parameters-and-complete-response">Example 03 - Specific JSON Request Parameters and Complete Response</h2>
<hr>
<p>In this example, we can see that the application is sending encrypted request parameters same as the previous case but now the content type is JSON and Burp API handles JSON parameters differently from normal Form or Multi-part content type.  In addition to that, this time the application is sending a response in Plain Text without any Encryption.</p>
<img src="https://i.imgur.com/Nj9kxVe.png">
<p>The configuration of AES Killer for this example is exactly the same as Example 02 but with a slight difference in Response Options</p>
<ul>
<li>Input <code>Secret Key</code>, <code>IV Parameters</code> and <code>Host URL</code></li>
<li>Select <code>Ignore Response</code> from <code>Response Options</code> as there is no encryption implemented on response in this example</li>
<li>Select <code>Specific Request Parameters</code> from <code>Request Options</code> and provide <strong>parameter names</strong> separated with space</li>
<li>Press <code>Start AES Killer</code></li>
</ul>
<img src="https://i.imgur.com/COva3tF.png">
<p>Let&rsquo;s move back to the application and send the request again</p>
<img src="https://i.imgur.com/Cfa4IO2.png">
<p>This time response is intact while AES Killer decrypted the JSON parameters in the request.</p>
<br>
<h2 id="example-04---specific-request-and-response-parameters">Example 04 - Specific Request and Response Parameters</h2>
<hr>
<p>The application is sending encrypted parameters in JSON and also getting encrypted parameters in the JSON body.</p>
<img src="https://i.imgur.com/vCsYpxc.png">
<p>The AES Killer configuration for such cases is as follow</p>
<ul>
<li>Input <code>Secret Key</code>, <code>IV Parameters</code> and <code>Host URL</code></li>
<li>Select <code>Specific Response Parameters</code> from <code>Response Options</code> as provide response <strong>parameter names</strong> separated with space</li>
<li>Select <code>Specific Request Parameters</code> from <code>Request Options</code> and provide request <strong>parameter names</strong> separated with space</li>
<li>Press <code>Start AES Killer</code></li>
</ul>
<img src="https://i.imgur.com/8HVWZHf.png">
<p>If we send request again, we&rsquo;ll be seeing the decrypted request and response parameters</p>
<img src="https://i.imgur.com/RMbTR74.png">
<p>The AES Killer will automatically encrypt the request before sending it to the application or server, so we can pentest it however we want</p>
 <img src="https://i.imgur.com/zYOQTVo.png">
<br>
<h2 id="example-05---override-request-and-response-variant-01">Example 05 - Override Request and Response (Variant-01)</h2>
<hr>
<p>In this example, we have a special case where the application is encrypting the whole request and then sending the encrypted string in the data parameter. Also, the application is sending encrypted string is JSON parameter in the response body.</p>
<img src="https://i.imgur.com/w7EVQX7.png">
<p>The AES Killer configuration for this type of scenarios is as below</p>
<ul>
<li>Input <code>Secret Key</code>, <code>IV Parameters</code> and <code>Host URL</code></li>
<li>Select <code>Specific Response Parameters</code> from <code>Response Options</code> as provide response <strong>parameter name</strong> separated with space and also select <code>Override Complete Response Body - JSON</code></li>
<li>Select <code>Specific Request Parameters</code> from <code>Request Options</code> and provide request <strong>parameter name</strong> separated with space and also select <code>Override Complete Request Body - Form</code></li>
<li>Press <code>Start AES Killer</code></li>
</ul>
<img src="https://i.imgur.com/bILppXv.png">
<p>Send request again from the Demo App again and observe the Request and Response</p>
<img src="https://i.imgur.com/JqohhEA.png">
<br>
<h2 id="example-06---override-request-and-response-variant-02">Example 06 - Override Request and Response (Variant-02)</h2>
<hr>
<p>In this example, the application behavior is inverse of Example 05 as shown below</p>
<img src="https://i.imgur.com/L2iyGKn.png">
<p>The AES Killer configuration for this type of scenarios is as below</p>
<ul>
<li>Input <code>Secret Key</code>, <code>IV Parameters</code> and <code>Host URL</code></li>
<li>Select <code>Specific Response Parameters</code> from <code>Response Options</code> as provide response <strong>parameter name</strong> separated with space and also select <code>Override Complete Response Body - Form</code></li>
<li>Select <code>Specific Request Parameters</code> from <code>Request Options</code> and provide request <strong>parameter name</strong> separated with space and also select <code>Override Complete Request Body - JSON</code></li>
<li>Press <code>Start AES Killer</code></li>
</ul>
<img src="https://i.imgur.com/GIUSkk6.png">
<p>The Decrypted Request and Response is</p>
<img src="https://i.imgur.com/LnOW8g4.png">

            </div>
        </article>

        <hr />

        <div class="post-info">
            
    <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line></svg>

        <span class="tag"><a href="https://n00b.sh/tags/burp/">burp</a></span>
        <span class="tag"><a href="https://n00b.sh/tags/aes-killer/">aes-killer</a></span>
        <span class="tag"><a href="https://n00b.sh/tags/burp-plugin/">burp-plugin</a></span>
        <span class="tag"><a href="https://n00b.sh/tags/java/">java</a></span>
        <span class="tag"><a href="https://n00b.sh/tags/burpsuite/">burpsuite</a></span>
        <span class="tag"><a href="https://n00b.sh/tags/burpsuite-tools/">burpsuite-tools</a></span>
        <span class="tag"><a href="https://n00b.sh/tags/burpsuite-plugin/">burpsuite-plugin</a></span>
        <span class="tag"><a href="https://n00b.sh/tags/burp-extension/">burp-extension</a></span>
        <span class="tag"><a href="https://n00b.sh/tags/decryptor/">decryptor</a></span>
        <span class="tag"><a href="https://n00b.sh/tags/aes-encryption/">aes-encryption</a></span>
        
    </p>

            
    <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-folder meta-icon"><path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path></svg>

        <span class="tag"><a href="https://n00b.sh/categories/guide/">guide</a></span>
        <span class="tag"><a href="https://n00b.sh/categories/pentest/">pentest</a></span>
        
    </p>

  		</div>
    </main>

            </div>

            
                <footer class="footer">
    <div class="footer__inner">
        <div class="footer__content">
            <span>&copy; 2021</span>
            <span><a href="https://n00b.sh">Abdul Wahab</a></span>
            <span><a href="https://n00b.sh/posts/index.xml" target="_blank" title="rss"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a></span>
        </div>
    </div>
    <div class="footer__inner">
        <div class="footer__content">
            
            
          </div>
    </div>
</footer>

            
        </div>

        



<script type="text/javascript" src="https://n00b.sh/bundle.min.599099f1f14b78b657d524b28e10e0c5098e7cd46e9c7aed73d577068a276c3ff1bb234cbf29cb313333e83cf411727b43157c91ce5b809e2ffc81664614608e.js" integrity="sha512-WZCZ8fFLeLZX1SSyjhDgxQmOfNRunHrtc9V3BoonbD/xuyNMvynLMTMz6Dz0EXJ7QxV8kc5bgJ4v/IFmRhRgjg=="></script>



    </body>
</html>
